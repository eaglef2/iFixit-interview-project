<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd ">

<html xmlns="http://www.w3.org/1999/xhtml " xml:lang="en" lang="en">
	<head>
		
	</head>
	
	<body>
		<p id="demo"></p>
		<p id="aa">fail</p>
		<div style="{height: '600px';width: '800px'}" id="outerDiv">
		</div>
		
	
		<script src = "mootools-core-1.4.5-full-compat.js">
		</script>
		<script src = "mootools-more-1.4.0.1.js"></script>
		
		<script>
		try {
			var div = document.id("outerDiv");
			
			
			function read(data) {
				document.getElementById("aa").innerHTML =
					"success";
				
				for (var a = 0; a < 20; a++) {
					var imgJSONP = new Request.JSONP( {
						url: "http://www.ifixit.com/api/0.1/device/" 
						    + data[a].device + "?jsonp=display"
					}).send();
				}
			}
			
			function display(data) {
				var newDiv = new Element('div', {
					id: 'innerDiv',
					styles: {
						display: 'inline',
						height: '100px',
						width: '100px',
					}
				});
				var elementAdd = new Element('img', {
					id: 'Image',
					styles: {
						height: "100px",
						width: "100px"
					},
					src: "",
					alt: ""
				});
				
				elementAdd.inject(newDiv);
				document.getElementById("aa").innerHTML = "pass";
				var imageurl = data.image.text;
				if (imageurl != null) {
					elementAdd.src = imageurl;	
				}
				elementAdd.alt = data.title;
				newDiv.inject(div);
			}
			
			var myJSONP = new Request.JSONP( {
				url: "http://www.ifixit.com/api/0.1/devices?"
				    + "jsonp=read",
			}).send();
		}
		catch (err) {
			document.write("ERROR\n");
			document.write(err.message);
		}
		</script>
	</body>
</html>
